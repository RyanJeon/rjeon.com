<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Ryan's Little Home</title>
	
	<meta name="author" content="Ryan Jeon">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/ryanjeon">
				<i class="fa fa-github"></i>
			</a>
			
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:ryanjeon98@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="https://s.gravatar.com/avatar/e687cb78cf4a1242610b00314122ce64?s=40" class="img-circle" />
				Ryan Jeon
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="https://s.gravatar.com/avatar/e687cb78cf4a1242610b00314122ce64?s=200" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">Ryan Jeon</a>
    </h3>
</header>


<div id="bio" class="text-center">
	I'm a software developer and a student. I am mainly interested in exploits and application development :)
</div>


<div id="contact-list" class="text-center">
	<div>
		<a class="btn btn-default btn-sm" style="margin:10px" href="/About">
			More About Me
		</a>
	</div>
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/ryanjeon">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:ryanjeon98@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/ryan-yejun-jeon-70b4a7145">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>SSH into RaspberryPi through GCP VM instance </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   June 
	   6th,
	   
	   2019
	 </span>
	  <div class="article_body" style="font-size: 30px">
	  <p>About a month ago I got my first ever personal RaspberryPi. Just like a kid who just got his 
first bike, I was filled with joy and excitement and wanted to play with it 24/7. But as a 
full time student, I was often far from home, and I had to contain myself from running back to my 
apartment to play with my Pi. I found a good solution to tackle this. I decided create a 
reverse SSH tunnel from my Pi to a GCP VM instance, so that I can SSH into my Pi from the VM already had remote access to.
This is very useful, because the alternative would have been port fowarding on my home router and 
this often is very cumbersome to do and manage. So let me share how I did it.</p>

<p><br />
First, create a GCP VM instance if you do not already have one following this <a href="https://cloud.google.com/compute/docs/instances/create-start-instance">guide</a></p>

<p>Next, Make sure you have gcloud sdk on your Pi. If not, you can install it with these commands:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c">    <span class="cp"># Create environment variable for correct distribution
</span>    <span class="n">CLOUD_SDK_REPO</span><span class="o">=</span><span class="s">"cloud-sdk-$(grep VERSION_CODENAME /etc/os-release | cut -d '=' -f 2)"</span>

    <span class="cp"># Add the Cloud SDK distribution URI as a package source
</span>    <span class="n">echo</span> <span class="s">"deb http://packages.cloud.google.com/apt $CLOUD_SDK_REPO main"</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="p">.</span><span class="n">list</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">google</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="n">sdk</span><span class="p">.</span><span class="n">list</span>

    <span class="cp"># Import the Google Cloud Platform public key
</span>    <span class="n">curl</span> <span class="n">https</span><span class="o">:</span><span class="c1">//packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -</span>

    <span class="cp"># Update the package list and install the Cloud SDK
</span>    <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">google</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="n">sdk</span>
    </code></pre></figure>

<p>Now, from your Pi, type the following command to create a reverse SSH tunnel to your VM instance. The REMOTE_PORT value will be the 
port that will be used on your VM instance to be fowarded to your Pi’s port 22 (Default SSH port)</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">gcloud</span> <span class="n">compute</span> <span class="o">--</span><span class="n">project</span> <span class="s">"PROJECT_NAME"</span> <span class="n">ssh</span> <span class="o">--</span><span class="n">zone</span> <span class="s">"VM_REGION"</span> <span class="s">"VM_NAME"</span> <span class="o">--</span> <span class="o">-</span><span class="n">f</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">R</span> <span class="n">REMOTE_PORT</span><span class="o">:</span><span class="n">localhost</span><span class="o">:</span><span class="mi">22</span></code></pre></figure>

<p>A brief explanation of the command flags:</p>
<ul>
  <li>-f: This runs SSH session to run in the background</li>
  <li>-N: Does not open a shell or execute program on the remote host</li>
  <li>-R: Creates a remote tunnel to your local machine (Your Pi)</li>
</ul>

<p>That’s it! Now just simply SSH into the port that you chose, and you can now access your Pi from anywhere around the world as long as 
your Pi is running and safe at home. Happy hacking!</p>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#general-ref">
					general <span>(4)</span>
					,
				</a></li>
			 
				<li><a href="/categories.html#demo-ref">
					demo <span>(3)</span>
					
				</a></li>
			
		  
		</ul>
		  

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#project-ref">
					project <span>(4)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#tutorial-ref">
					tutorial <span>(1)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=SSH into RaspberryPi through GCP VM instance"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="//www.gravatar.com/avatar/e687cb78cf4a1242610b00314122ce64" class="img-rounded author-image" />
        <h4 class="section-title author-name">Ryan Jeon</h4>
        <p class="author-bio">I'm a software developer and a student. I am mainly interested in exploits and application development :)</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/general/demo/2019/06/05/side1.html" title="(SideTrack 1) File Polyglot">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/general/coding/2019/06/10/compiler1.html" title="Writing a programming language (Part 1 Layout)">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>





		<footer>
			<hr/>
			<p>
				&copy; 2019 Ryan Jeon
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'Ryan', 'auto');
  ga('send', 'pageview');
</script>

